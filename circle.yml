general:
  build_dir: Ambassador

machine:
  timezone:
    America/Detroit
  xcode:
    version: "7.0"
checkout:
  post:
    - git submodule sync
    - git submodule update --init
dependencies:
  pre:
    - brew uninstall xctool && brew install --HEAD xctool
    - gem install cocoapods xcpretty obcd slather -N
test:
  override:
    - xctool
      -reporter pretty
      -reporter junit:$CIRCLE_TEST_REPORTS/xcode/results.xml
      -reporter plain:$CIRCLE_ARTIFACTS/xctool.log
      -destination 'platform=iOS Simulator,name=iPhone 6,OS=9.0'
      -sdk iphonesimulator
      -project 'Ambassador.xcodeproj'
      -scheme "Ambassador"
      build build-tests
      GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=YES GCC_GENERATE_TEST_COVERAGE_FILES=YES clean test | xcpretty -c
