general:
  build_dir: Ambassador

machine:
  timezone:
    America/Detroit
  xcode:
    version: "7.0"
checkout:
  post:
    - git submodule sync
    - git submodule update --init
dependencies:
  pre:
    - sudo gem install cocoapods xcpretty obcd slather -N
test:
  override:
    - set -o pipefail && xcodebuild
        -project 'Ambassador.xcodeproj'
        -scheme "TestApplication"
        -sdk iphonesimulator -destination 'platform=iOS Simulator,OS=9.0,name=iPhone 6'
        GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=YES GCC_GENERATE_TEST_COVERAGE_FILES=YES clean test | xcpretty -c
        --report junit --output ${CIRCLE_TEST_REPORTS}/junit.xml
  post:
      - bundle exec slather coverage -s Ambassador.xcodeproj
